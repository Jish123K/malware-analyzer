import tkinter as tk

from tkinter import filedialog

from tkinter import messagebox

import yara

import requests

# Define the main window

root = tk.Tk()

root.title("Malware Detector")

# Create a label for the file selection

label_file = tk.Label(root, text="Select a file:")

label_file.pack()

# Create a button for opening a file

button_open = tk.Button(root, text="Open", command=open_file)

button_open.pack()

# Create a label for the scan results

label_results = tk.Label(root, text="Scan results:")

label_results.pack()

# Create a text box for the scan results

text_box = tk.Text(root, width=40, height=20)

text_box.pack()

# Define a function to open a file

def open_file():

    # Get the file path from the user

    file_path = filedialog.askopenfilename()

    # Check if the file is a valid file

    if not file_path:

        return
        # Scan the file for malware

    is_malware = scan_file(file_path)

    # Update the scan results

    if is_malware:

        text_box.insert(tk.END, "The file is infected with malware.")

    else:

        text_box.insert(tk.END, "The file is clean.")

# Define a function to scan a file for malware

def scan_file(file_path):

    # Load the yara rules

    rules = yara.compile(open("rules.yar").read())

    # Scan the file for matches

    matches = rules.match(file_path)

    # Check if any matches were found

    if matches:

        return True

    else:

        return False
